
<!DOCTYPE html>
<html lang="lv">
  <head>
    <meta charset="utf-8" />
    <title>Gatis Tomsons: 7 dienu backups</title>
    
    <meta name="description" content="Gata Tomsona tīmekļa vietne" />
    
    <meta content="index, follow" name="robots" />
    <meta content="Gatis Tomsons" name="author" />
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400|Jura:300" rel="stylesheet" type="text/css" />
    <link href="http://gacha.id.lv/atom.xml" rel="alternate" title="Raksti RSS formātā" type="application/atom+xml" />
    <link href="/assets/css/global.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/assets/css/pygments_pastie.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/assets/css/colorbox.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/jquery.colorbox-min.js" type="text/javascript"></script>
    <script src="/assets/js/jquery.timeago.js" type="text/javascript"></script>
  </head>
  <body>
    <header>
      <a href="/">
        <h1>Gatis Tomsons</h1>
        <h2>rocket science</h2>
      </a>
    </header>
    <nav>
      <ul>
        <li><a href="/">Sākums</a></li>
        <li><a href="/arhivs.html">Rakstu arhīvs</a></li>
      </ul>
    </nav>
    <section id="content">
<article>
  <h1>7 dienu backups</h1> 
  <div class="body">

		
			
<p>Kā jau visi zin, tad īsti džeki backupu nekad netaisa, bet sagadījies tā, ka apstākļi spiež man to darīt. Tad nu meklēju visvienkāršāko veidu, kā to paveikt un protams pirmais, kas ienāk prātā ir <a href="http://samba.anu.edu.au/rsync/">rsync</a> programmiņa, ar kuras palīdzību var veikt visādas failu sinhronizācijas, tai skaitā arī backup veidošanu. Viņu lapusē pie <a href="http://samba.anu.edu.au/rsync/examples.html">examples</a> izmantojot pirmo piemēru izveidoju šādu skriptu:  <br />
</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/sh</span>

<span class="nv">SOURCE</span><span class="o">=</span>/var/www/
<span class="nv">DESTINATION</span><span class="o">=</span>/archive/www/<span class="sb">`</span>date +%A<span class="sb">`</span>
<span class="nv">EXCLUDES</span><span class="o">=</span>/archive/www/excludes


<span class="nv">OPTS</span><span class="o">=</span><span class="p">&amp;</span>quot<span class="p">;</span>--backup --backup-dir<span class="o">=</span><span class="nv">$DESTINATION</span> --delete -a --ignore-errors --delete-excluded --exclude-from<span class="o">=</span><span class="nv">$EXCLUDES</span><span class="p">&amp;</span>quot<span class="p">;</span>

rsync <span class="nv">$OPTS</span> <span class="nv">$SOURCE</span> <span class="nv">$DESTINATION</span></code></pre></div>
<p><em>SOURCE</em> ir mape, kuru arhivēt, <em>DESTINATION</em> ir mape uz kuru arhivēt un <em>EXCLUDES</em> ir fails ar lietām, kuras nav nepieciešams arhivēt. Šo skriptu ieliku <code>/etc/cron.daily/</code> mapē un uzliku tam <code>chmod +x</code>, lai tas katru dienu izpildītos. Kā rezultātā iegūšu 7 dienu arhīvu, jo <em>rsync</em> katru dienu sinhronizēs arhīvu uz mapi ar tekošās dienas nosaukumu. Vēl es <em>EXCLUDE</em> failā ierakstiju tādas rindas, kā *.jpg, *.png utm., lai taupītu hdd vietu, bet tas jau katram individuāli.  <br />
</p>
<p><strong>Papildināts</strong> <br />
</p>
<p>Pēc <a href="http://atoms.netparks.lv/blog/">Atoma</a> ieteikuma pamēģināju <a href="http://www.nongnu.org/rdiff-backup/">rdiff-backup</a> un secināju, ka tas ir tieši tas, kas man nepieciešams, jo tas veido failu versiju sistēmu līdzīgu, kā <a href="http://subversion.tigris.org/">svn</a> un tādēļ saglabājot 7 dienu arhīvu es ietaupu daudz vietas uz hdd, jo dati netiek dublēti. Vēl man patīk tas, ka datus ir ļoti elementāri dabūt atpakaļ, piemēram es vēlos atgriezt <code>/etc/make.conf</code> tādu, kāds tas bija 3 dienas atpakaļ - <code>rdiff-backup -r 3D /backup/etc/make.conf /tmp/make.conf</code>, tik pat viegli var arī izdzēst failus kuri vecāki par noteiktu laiku.
</p>

		
	</div>
  <div class="clear"></div>
  <div class="pagination">
    <ul>
    
      <li class="prev"><a href="/blog/06/10/2006/miljons-paldies" title="Miljons paldies">&larr; Iepriekšējais</a></li>
    
      <li><a href="/arhivs.html">Rakstu arhīvs</a></li>
    
      <li class="next"><a href="/blog/19/10/2006/irc-jocii" title="IRC jociņi">Nākamais &rarr;</a></li>
    
    </ul>
  </div>
  
</article>
<aside>
  <h4>Publicēts</h4>
  <time datetime="2006-10-10 00:00:00 +0300">2006. gada 10. oktobrī</time>
  
    <h4>Tagi</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tagi.html#linux-ref">linux <span>16</span></a></li>
    
  



    </ul>
    <br class="clear" />
  
  <g:plusone annotation="inline"></g:plusone>
  <script type="text/javascript">
    window.___gcfg = {lang: 'lv'};
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>
</aside>
<div class="clear"></div></section>
    <footer id="footer">
      <p>© 2006-2015 Gatis Tomsons</p>
    </footer>
    
  </body>
</html>
